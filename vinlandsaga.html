<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review & Watch Vinland Saga - Anikan</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
    
    </head>
<body>

    <header class="main-header">
        <a href="home.html" class="logo">Ani<span>kan</span></a>
        <nav class="nav-links">
            <a href="home.html">Home</a>
            <a href="movies.html">Movies</a>
            <a href="categories.html">Genre</a>
        </nav>
        <div class="main-header .search-bar" style="display: none;">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search...">
        </div>
        <div class="main-header .user-profile" style="display: none;">
            <img src="profile.jpg" alt="User Profile">
        </div>
    </header>

    <main>
        <div class="review-wrapper" id="review-wrapper">
            <section class="hero-banner" id="hero-banner-section">
                <div class="hero-content">
                    <h1 id="anime-title-main"></h1>
                    <div class="hero-meta">
                        <span id="hero-meta-year"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-type"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-duration"></span>
                    </div>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                </div>
            </section>
            
            <div class="review-main-content">
                <div class="left-sidebar">
                    <img id="anime-poster" class="movie-poster" src="" alt="Anime Poster">
                    
                    <div class="mobile-hero-buttons">
                        <button class="btn btn-primary" id="mobile-play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="mobile-trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                    
                    <div class="watchlist-section">
                        <button id="add-to-watchlist-btn"><i class="fas fa-plus"></i> Add to Watchlist</button>
                        <div class="user-rating-stars" id="user-rating-stars">
                        </div>
                    </div>
                </div>

                <div>
                    <div class="info-panel">
                        <div class="info-details">
                            <ul>
                                <li><strong>Title:</strong> <span id="info-title"></span></li>
                                <li><strong>Cast:</strong> <span id="info-cast"></span></li>
                                <li><strong>Creator:</strong> <span id="info-creator"></span></li>
                                <li><strong>Genre:</strong> <span id="info-genre"></span></li>
                            </ul>
                        </div>
                        <div class="info-rating-circle">
                            <div class="rating-circle-bg" id="rating-circle">
                                <div class="rating-circle-inner">
                                    <span class="rating-score" id="rating-score"></span>
                                    <span class="rating-max">out of 10</span>
                                </div>
                            </div>
                            <p class="personal-rating-note">note: personal rating only</p>
                        </div>
                    </div>

                    <div class="synopsis-panel">
                        <h2 class="section-title">Synopsis</h2>
                        <p id="synopsis-text"></p>
                    </div>

                    <h2 class="section-title">Photos</h2>
                    <div class="photos-grid" id="photos-grid"></div>

                    <h2 class="section-title">Official Trailer</h2>
                    <div class="trailer-panel">
                        <div class="player-container">
                            <iframe id="trailer-player" src="" title="Official Trailer Player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
                         </div>
                    </div>

                    <h2 class="section-title">Main Characters</h2>
                    <div class="characters-grid" id="character-list"></div>

                    <h2 class="section-title">Who is this Anime for?</h2>
                    <div class="synopsis-panel">
                        <p id="anime-audience"></p>
                    </div>

                    <h2 class="section-title">Where to Watch Officially</h2>
                    <div class="official-stream-grid" id="official-streams"></div>
                </div>
            </div>
        </div>
        
        <section class="watch-section" id="watch-section">
            <div class="watch-layout" id="watch-layout">
                <div class="main-content-col">
                    <div class="video-player-container">
                        <iframe 
                            id="video-player-iframe"
                            src="" 
                            title="Video Player" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen>
                        </iframe>
                    </div>

                    <div class="episode-meta">
                        <h1 class="episode-title" id="current-episode-title"></h1>
                        <div class="episode-actions">
                            <button class="action-btn" id="prev-ep-btn"><i class="fas fa-arrow-left"></i>Prev</button>
                            <button class="action-btn" id="next-ep-btn">Next<i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <div class="widget episodes-list-widget">
                        <h2 class="widget-title">Episodes</h2>
                        <div class="episodes-list" id="episodes-list-container">
                        </div>
                    </div>
                    
                    <div class="widget download-widget">
                        <h2 class="widget-title">Download (Placeholder Links)</h2>
                        <div class="download-list">
                            <table>
                                <thead>
                                    <tr><th>Episode</th><th>Quality</th><th>Video</th><th>Subtitles</th></tr>
                                </thead>
                                <tbody id="download-links-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="sidebar-col">
                    <div class="widget drama-info-widget">
                        <div class="info-poster"><img id="sidebar-poster" src="" alt="Anime Poster"></div>
                        <h2 class="info-title-sidebar" id="sidebar-title"></h2>
                        <div class="info-details">
                            <p><span>Type:</span> <span id="sidebar-type"></span></p>
                            <p><span>Episodes:</span> <span id="sidebar-episodes"></span></p>
                            <p><span>Duration:</span> <span id="sidebar-duration"></span></p>
                            <p><span>Studio:</span> <span id="sidebar-studio"></span></p>
                            <p><span>Score:</span> <span id="sidebar-score"></span></p>
                            <p><span>Genres:</span> <span id="sidebar-genres"></span></p>
                        </div>
                    </div>
                    <div class="widget recommendations-widget">
                        <h2 class="widget-title">More from Anikan</h2>
                        <div class="recommendations-list">
                           <p style="color: var(--color-text-muted); font-size: 0.9rem;">Recommendation list placeholder.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Data: Vinland Saga (Seasons 1 & 2) ---
            const selectedAnime = {
                id: 2, 
                title: 'Vinland Saga', 
                title_japanese: 'ヴィンランド・サガ',
                cast: ['Yūto Uemura (Thorfinn)', 'Naoya Uchida (Askeladd - Season 1)', 'Kenshō Ono (Canute)'],
                characters: [
                    { name: 'Thorfinn', image: 'https://img.gamdb.com/character/large/63bae4299e735d59ef9ec44663bae43c-ns.png' }, 
                    { name: 'Askeladd', image: 'https://static.wikia.nocookie.net/villains/images/6/6c/Askelad.PNG/revision/latest?cb=20250401214117' }, 
                    { name: 'Canute', image: 'https://static.wikia.nocookie.net/villains/images/a/ae/Thekingcanute.PNG/revision/latest?cb=20250401213714' } 
                ],
                creator: 'Makoto Yukimura (Manga)', 
                studio: 'Wit Studio (S1), MAPPA (S2)',
                type: 'TV Series', 
                EPs: 48, // Total Episodes (S1: 24, S2: 24)
                genres: ['Action', 'Adventure', 'Drama', 'Historical', 'Seinen'],
                duration: '24 min', 
                rating: 8.7, 
                description: "Set at the start of the 11th century, Vinland Saga follows the young Thorfinn, a Viking warrior whose life is dedicated to vengeance against the man who killed his father: the brilliant and pragmatic mercenary Askeladd. As Thorfinn chases his deadly feud, the story evolves into an epic of war, political upheaval, and Thorfinn’s search for meaning and a peaceful land called Vinland, free from violence. Season 1 focuses on war and revenge, while Season 2 shifts dramatically to themes of peace, slavery, and redemption.",
                audience: 'Fans of mature, historical dramas with complex characters and deep philosophical themes. It appeals strongly to the Seinen audience who value psychological depth and character growth over endless action. Mandatory watch for those who loved series like Berserk and Kingdom.',
                coverImage: 'https://m.media-amazon.com/images/M/MV5BNDA3MGNmZTEtMzFiMy00ZmViLThhNmQtMjQ4ZDc5MDEyN2U1XkEyXkFqcGc@._V1_.jpg', 
                bgImage: 'https://preview.redd.it/created-a-fan-trailer-for-vinland-saga-season-3-this-was-my-v0-5d9r47g8jj6f1.png?width=1080&crop=smart&auto=webp&s=1519417bfdab8c9c0e8f014a702f88224511565a', // S2 Key Visual Placeholder
                releaseYear: 2019, 
                trailer_url: 'https://www.youtube.com/embed/fD3lM0T7u-Y', // S1 Trailer Placeholder
                official_streams: [
                    { platform: 'Crunchyroll', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Crunchyroll.svg/1024px-Crunchyroll.svg.png' }, 
                    { platform: 'Netflix', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png' } 
                ],
                gallery: [
                    'https://www.thepopverse.com/_next/image?url=https%3A%2F%2Fmedia.thepopverse.com%2Fmedia%2Fvinland-saga-1-hctdun54h2lernr0kf2fcdbeca.jpg&w=1280&q=75', 
                    'https://images.immediate.co.uk/production/volatile/sites/3/2021/06/VINLAND-SAGA-80c4a05.png?resize=1200%2C630', 
                    'https://cdn.mos.cms.futurecdn.net/QzsHeuJGx7XWq4nuxxCNnH-1920-80.jpg', 
                    'https://otakuusamagazine.com/wp-content/uploads/2020/08/vinland-saga-anime-review-2.jpg', 
                    'https://images.squarespace-cdn.com/content/v1/5ace4845e17ba35c9d8eb95e/ae0a750d-101e-4bdf-8a85-da70ac123aea/thorfinn+and+einar.PNG', 
                    'https://www.animeexplained.com/wp-content/uploads/2023/05/Thorfinn-True-warrior-featured.jpg' 
                ]
            };

            // --- EP DATA: Vinland Saga (48 EPs - S1 & S2) ---
            const episodeData = [
                // Season 1 (24 Episodes) - War and Revenge Arc
                { number: 1, title: 'EP 1: Where the Wind Blows', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=1', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 2, title: 'EP 2: Sword', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=2', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 3, title: 'EP 3: Troll', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=3', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 4, title: 'EP 4: A True Warrior', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=4', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 5, title: 'EP 5: The Son of the Sea', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=5', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 6, title: 'EP 6: The Iron Fist', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=6', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 7, title: 'EP 7: North Sea War', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=7', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 8, title: 'EP 8: Beyond the Edge of the Sea', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=8', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 9, title: 'EP 9: The Battle of London', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=9', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 10, title: 'EP 10: Ragnarok', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=10', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 11, title: 'EP 11: A Bet', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=11', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 12, title: 'EP 12: The Land on the Far Bank', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=12', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 13, title: 'EP 13: The Child of a Hero', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=13', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 14, title: 'EP 14: The Light of Dawn', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=14', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 15, title: 'EP 15: Disruption', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=15', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 16, title: 'EP 16: History of the Beasts', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=16', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 17, title: 'EP 17: Servant', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=17', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 18, title: 'EP 18: Out of the Cradle', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=18', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 19, title: 'EP 19: United Front', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=19', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 20, title: 'EP 20: Crown', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=20', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 21, title: 'EP 21: A Thousand-Year Promise', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=21', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 22, title: 'EP 22: The Deep Road', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=22', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 23, title: 'EP 23: Miscalculation', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=23', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 24, title: 'EP 24: End of the Prologue', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=1&e=24', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                
                // Season 2 (24 Episodes) - Slave and Farmland Arc
                { number: 25, title: 'EP 25: Slave', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=1', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 26, title: 'EP 26: The Farm', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=2', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 27, title: 'EP 27: The Journey', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=3', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 28, title: 'EP 28: A Nondescript Man', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=4', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 29, title: 'EP 29: The Thunder', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=5', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 30, title: 'EP 30: I Want Peace', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=6', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 31, title: 'EP 31: Iron Fist Ketil', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=7', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 32, title: 'EP 32: The Call of War', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=8', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 33, title: 'EP 33: Binding Oath', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=9', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 34, title: 'EP 34: The Decisive Battle', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=10', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 35, title: 'EP 35: Kings and Swords', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=11', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 36, title: 'EP 36: For a True Man', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=12', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 37, title: 'EP 37: The King of Denmark', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=13', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 38, title: 'EP 38: The Empty Man', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=14', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 39, title: 'EP 39: Windfall', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=15', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 40, title: 'EP 40: Sentimentality', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=16', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 41, title: 'EP 41: The Cause of the Fighting', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=17', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 42, title: 'EP 42: The First Step', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=18', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 43, title: 'EP 43: King Canute', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=19', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 44, title: 'EP 44: Farewell', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=20', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 45, title: 'EP 45: The End of the Farm', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=21', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 46, title: 'EP 46: The Way Home', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=22', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 47, title: 'EP 47: Empty Life', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=23', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 48, title: 'EP 48: Einar and Thorfinn', videoUrl: 'https://multiembed.mov/?video_id=tt10233448&s=2&e=24', thumbnail: 'https://occ-0-8407-90.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABcfnb1WNPpbtzux8Lezcebs_gKJJjortz8tzoCGFDHw-BpSZ8jT0J53-5w_DaUblLiHxdRP4dTyYm-O5UEHYfbjytKfc9AW39dDA.jpg?r=516', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }
            ];
            
            // --- Page Elements ---
            const videoPlayer = document.getElementById('video-player-iframe');
            const episodesListContainer = document.getElementById('episodes-list-container');
            const downloadLinksTbody = document.getElementById('download-links-tbody');
            const currentEpisodeTitle = document.getElementById('current-episode-title');
            const prevBtn = document.getElementById('prev-ep-btn');
            const nextBtn = document.getElementById('next-ep-btn');

            // --- Button Elements ---
            const playButton = document.getElementById('play-button');
            const mobilePlayButton = document.getElementById('mobile-play-button');
            const trailerButton = document.getElementById('trailer-button');
            const mobileTrailerButton = document.getElementById('mobile-trailer-button');
            const addToWatchlistBtn = document.getElementById('add-to-watchlist-btn');

            let currentEpisodeIndex = 0; // Index starting at 0
            const totalEpisodes = episodeData.length;

            function populateReviewSection() {
                // --- Review Population Logic ---
                document.title = `Review & Watch ${selectedAnime.title} - Anikan`;
                document.getElementById('hero-banner-section').style.backgroundImage = `url('${selectedAnime.bgImage}')`;
                document.getElementById('anime-title-main').textContent = selectedAnime.title;
                document.getElementById('hero-meta-year').textContent = selectedAnime.releaseYear;
                document.getElementById('hero-meta-type').textContent = selectedAnime.type;
                document.getElementById('hero-meta-duration').textContent = `${selectedAnime.duration}`;
                document.getElementById('anime-poster').src = selectedAnime.coverImage;
                document.getElementById('info-title').textContent = selectedAnime.title;
                document.getElementById('info-cast').textContent = selectedAnime.cast.join(', ');
                document.getElementById('info-creator').textContent = selectedAnime.creator;
                document.getElementById('info-genre').textContent = selectedAnime.genres.join(', ');
                const ratingCircle = document.getElementById('rating-circle');
                document.getElementById('rating-score').textContent = selectedAnime.rating;
                if (ratingCircle) {
                    // Set color and rotation based on score
                    const score = selectedAnime.rating;
                    let color = 'var(--color-primary)'; // Default or high
                    if (score < 7.0) color = 'var(--color-warning)';
                    else if (score < 8.5) color = 'var(--color-highlight)';

                    ratingCircle.style.setProperty('--rating-percent', selectedAnime.rating * 10);
                    ratingCircle.style.borderColor = color;
                    ratingCircle.style.boxShadow = `0 0 10px ${color}`;
                }
                document.getElementById('synopsis-text').textContent = selectedAnime.description;
                // Using an imgur CDN link for the high-quality images
                document.getElementById('photos-grid').innerHTML = selectedAnime.gallery.map(img => `<img src="${img}" alt="Gallery image">`).join('');
                document.getElementById('trailer-player').src = selectedAnime.trailer_url;
                document.getElementById('character-list').innerHTML = selectedAnime.characters.map(char =>
                    `<div class="character-card"><img src="${char.image}" alt="${char.name}"><h4>${char.name}</h4></div>`
                ).join('');
                document.getElementById('anime-audience').textContent = selectedAnime.audience;
                const officialStreamsContainer = document.getElementById('official-streams');
                officialStreamsContainer.innerHTML = selectedAnime.official_streams.map(stream =>
                    `<a href="#" class="stream-logo"><img src="${stream.logo}" alt="${stream.platform}"></a>`
                ).join('');
                
                // Populate Sidebar Info
                document.getElementById('sidebar-poster').src = selectedAnime.coverImage;
                document.getElementById('sidebar-title').textContent = selectedAnime.title;
                document.getElementById('sidebar-type').textContent = selectedAnime.type;
                document.getElementById('sidebar-episodes').textContent = selectedAnime.EPs;
                document.getElementById('sidebar-duration').textContent = selectedAnime.duration;
                document.getElementById('sidebar-studio').textContent = selectedAnime.studio;
                document.getElementById('sidebar-score').textContent = selectedAnime.rating + '/10';
                document.getElementById('sidebar-genres').textContent = selectedAnime.genres.join(', ');
            }
            
            // --- NEW LOGIC: Using episodeData constant ---

            function updateUI(episodeIndex) {
                currentEpisodeIndex = parseInt(episodeIndex, 10);
                const episode = episodeData[currentEpisodeIndex];
                
                if (!episode) return;
                
                const episodeNumber = episode.number;
                // Use regex to get the part of the title after the number/colon for cleaner display in the H1
                const displayTitle = episode.title.match(/(?::\s?)(.*)/)?.[1] || episode.title;

                currentEpisodeTitle.textContent = `You are watching Episode ${episodeNumber} - ${displayTitle}`;
                
                // 1. Update Video Player
                videoPlayer.src = episode.videoUrl;

                // 2. Update Download Links
                downloadLinksTbody.innerHTML = '';
                const downloadQualities = Object.keys(episode.downloads);
                const subtitleUrl = episode.subtitleUrl || '#';
                
                if (downloadQualities.length > 0) {
                     downloadQualities.forEach(quality => {
                        const downloadUrl = episode.downloads[quality];
                        downloadLinksTbody.innerHTML += `
                            <tr>
                                <td data-label="Episode">Episode ${episodeNumber}</td>
                                <td data-label="Quality">${quality}</td>
                                <td data-label="Video"><a href="${downloadUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-download"></i> Download</a></td>
                                <td data-label="Subtitles"><a href="${subtitleUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-closed-captioning"></i> Download</a></td>
                            </tr>`;
                    });
                } else {
                    downloadLinksTbody.innerHTML = `<tr><td colspan="4" style="text-align: center; color: var(--color-text-muted);">Download links not available for this episode.</td></tr>`;
                }
                
                // 3. Update Episode List Active State and scroll
                episodesListContainer.querySelectorAll('.episode-item').forEach(link => link.classList.remove('current'));
                const activeEpisodeLink = episodesListContainer.querySelector(`.episode-item[data-episode='${episodeNumber}']`);
                if (activeEpisodeLink) {
                    activeEpisodeLink.classList.add('current');
                    activeEpisodeLink.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }

                // 4. Update Navigation Buttons
                prevBtn.disabled = episodeNumber === 1;
                nextBtn.disabled = episodeNumber === totalEpisodes;
            }

            function generateEpisodeList() {
                episodesListContainer.innerHTML = '';
                episodeData.forEach((ep, index) => {
                    const episodeNumber = ep.number;
                    const episodeTitle = ep.title.match(/(?::\s?)(.*)/)?.[1] || ep.title; // Clean up title for display
                    
                    const itemHTML = `
                        <a class="episode-item" data-episode="${episodeNumber}" data-episode-index="${index}">
                            <img src="${ep.thumbnail}" alt="Ep ${episodeNumber}" class="episode-thumbnail">
                            <div class="ep-info">
                                <p class="ep-number">Episode ${episodeNumber}</p>
                                <p class="ep-desc">${episodeTitle}</p>
                            </div>
                        </a>
                    `;
                    episodesListContainer.innerHTML += itemHTML;
                });
                
                // Attach click listeners to the generated list items
                episodesListContainer.querySelectorAll('.episode-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        updateUI(item.dataset.episodeIndex);
                    });
                });
            }


            // --- Event Handlers ---
            const handlePlayClick = () => {
                document.body.classList.add('watching-active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                generateEpisodeList(); // Generate list and attach click handlers
                
                // Initialize the player with the first EP
                if (episodeData.length > 0) {
                    updateUI(0);
                }
            };
            
            const handleTrailerClick = () => {
                const trailerElement = document.getElementById('trailer-player');
                if (trailerElement) {
                    trailerElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };
            
            const handleAddToWatchlist = async () => {
                // Placeholder logic as in original
                const username = null; // Assuming no user is logged in
                if (!username) {
                    alert('Please log in to add to your watchlist.');
                    // window.location.href = '/login.html';
                    return;
                }
            };

            // --- Navigation Event Listeners ---
            prevBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex > 0) updateUI(currentEpisodeIndex - 1); 
            });
            nextBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex < totalEpisodes - 1) updateUI(currentEpisodeIndex + 1); 
            });

            // --- Other Event Listeners ---
            playButton.addEventListener('click', handlePlayClick);
            mobilePlayButton.addEventListener('click', handlePlayClick);
            trailerButton.addEventListener('click', handleTrailerClick);
            mobileTrailerButton.addEventListener('click', handleTrailerClick);
            addToWatchlistBtn.addEventListener('click', handleAddToWatchlist);

            // --- Initialize Page ---
            populateReviewSection();
        });
    </script>
</body>
</html>