<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review & Watch Tokyo Revengers - Anikan</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
    
    </head>
<body>

    <header class="main-header">
        <a href="home.html" class="logo">Ani<span>kan</span></a>
        <nav class="nav-links">
            <a href="home.html">Home</a>
            <a href="movies.html">Movies</a>
            <a href="categories.html">Genre</a>
        </nav>
        <div class="main-header .search-bar" style="display: none;">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search...">
        </div>
        <div class="main-header .user-profile" style="display: none;">
            <img src="profile.jpg" alt="User Profile">
        </div>
    </header>

    <main>
        <div class="review-wrapper" id="review-wrapper">
            <section class="hero-banner" id="hero-banner-section">
                <div class="hero-content">
                    <h1 id="anime-title-main"></h1>
                    <div class="hero-meta">
                        <span id="hero-meta-year"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-type"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-duration"></span>
                    </div>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                </div>
            </section>
            
            <div class="review-main-content">
                <div class="left-sidebar">
                    <img id="anime-poster" class="movie-poster" src="" alt="Anime Poster">
                    
                    <div class="mobile-hero-buttons">
                        <button class="btn btn-primary" id="mobile-play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="mobile-trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                    
                    <div class="watchlist-section">
                        <button id="add-to-watchlist-btn"><i class="fas fa-plus"></i> Add to Watchlist</button>
                        <div class="user-rating-stars" id="user-rating-stars">
                        </div>
                    </div>
                </div>

                <div>
                    <div class="info-panel">
                        <div class="info-details">
                            <ul>
                                <li><strong>Title:</strong> <span id="info-title"></span></li>
                                <li><strong>Cast:</strong> <span id="info-cast"></span></li>
                                <li><strong>Creator:</strong> <span id="info-creator"></span></li>
                                <li><strong>Genre:</strong> <span id="info-genre"></span></li>
                            </ul>
                        </div>
                        <div class="info-rating-circle">
                            <div class="rating-circle-bg" id="rating-circle">
                                <div class="rating-circle-inner">
                                    <span class="rating-score" id="rating-score"></span>
                                    <span class="rating-max">out of 10</span>
                                </div>
                            </div>
                            <p class="personal-rating-note">note: personal rating only</p>
                        </div>
                    </div>

                    <div class="synopsis-panel">
                        <h2 class="section-title">Synopsis</h2>
                        <p id="synopsis-text"></p>
                    </div>

                    <h2 class="section-title">Photos</h2>
                    <div class="photos-grid" id="photos-grid"></div>

                    <h2 class="section-title">Official Trailer</h2>
                    <div class="trailer-panel">
                        <div class="player-container">
                            <iframe id="trailer-player" src="" title="Official Trailer Player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
                         </div>
                    </div>

                    <h2 class="section-title">Main Characters</h2>
                    <div class="characters-grid" id="character-list"></div>

                    <h2 class="section-title">Who is this Anime for?</h2>
                    <div class="synopsis-panel">
                        <p id="anime-audience"></p>
                    </div>

                    <h2 class="section-title">Where to Watch Officially</h2>
                    <div class="official-stream-grid" id="official-streams"></div>
                </div>
            </div>
        </div>
        
        <section class="watch-section" id="watch-section">
            <div class="watch-layout" id="watch-layout">
                <div class="main-content-col">
                    <div class="video-player-container">
                        <iframe 
                            id="video-player-iframe"
                            src="" 
                            title="Video Player" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen>
                        </iframe>
                    </div>

                    <div class="episode-meta">
                        <h1 class="episode-title" id="current-episode-title"></h1>
                        <div class="episode-actions">
                            <button class="action-btn" id="prev-ep-btn"><i class="fas fa-arrow-left"></i>Prev</button>
                            <button class="action-btn" id="next-ep-btn">Next<i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <div class="widget episodes-list-widget">
                        <h2 class="widget-title">Episodes</h2>
                        <div class="episodes-list" id="episodes-list-container">
                        </div>
                    </div>
                    
                    <div class="widget download-widget">
                        <h2 class="widget-title">Download (Placeholder Links)</h2>
                        <div class="download-list">
                            <table>
                                <thead>
                                    <tr><th>Episode</th><th>Quality</th><th>Video</th><th>Subtitles</th></tr>
                                </thead>
                                <tbody id="download-links-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="sidebar-col">
                    <div class="widget drama-info-widget">
                        <div class="info-poster"><img id="sidebar-poster" src="" alt="Anime Poster"></div>
                        <h2 class="info-title-sidebar" id="sidebar-title"></h2>
                        <div class="info-details">
                            <p><span>Type:</span> <span id="sidebar-type"></span></p>
                            <p><span>Episodes:</span> <span id="sidebar-episodes"></span></p>
                            <p><span>Duration:</span> <span id="sidebar-duration"></span></p>
                            <p><span>Studio:</span> <span id="sidebar-studio"></span></p>
                            <p><span>Score:</span> <span id="sidebar-score"></span></p>
                            <p><span>Genres:</span> <span id="sidebar-genres"></span></p>
                        </div>
                    </div>
                    <div class="widget recommendations-widget">
                        <h2 class="widget-title">More from Anikan</h2>
                        <div class="recommendations-list">
                           <p style="color: var(--color-text-muted); font-size: 0.9rem;">Recommendation list placeholder.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Data: Tokyo Revengers (All Seasons: Toman/Moebius/Valhalla/Christmas Showdown/Tenjiku Arc) ---
            const selectedAnime = {
                id: 1, 
                title: 'Tokyo Revengers', 
                title_japanese: '東京リベンジャーズ',
                // Using prominent voice actors for main characters and rival gang leaders
                cast: ['Yuuki Shin (Takemichi Hanagaki)', 'Yuu Hayashi (Manjiro "Mikey" Sano)', 'Tatsuhisa Suzuki/Masaya Fukunishi (Ken "Draken" Ryuguji)', 'Azumi Waki (Hinata Tachibana)'], 
                characters: [
                    { name: 'Takemichi Hanagaki', image: 'https://cdn.rafled.com/anime-icons/images/76bcb56b5d3e55026143afda9e05c2e7c057cbc114b01940a0346a706124b412.jpg' }, 
                    { name: 'Manjiro "Mikey" Sano', image: 'https://i.pinimg.com/736x/5e/84/a8/5e84a88baf8f2c536835003c93565b58.jpg' }, 
                    { name: 'Ken "Draken" Ryuguji', image: 'https://i.pinimg.com/736x/7d/e7/73/7de77398a753f7d46c298486e675457f.jpg' },
                    { name: 'Tetta Kisaki', image: 'https://i.redd.it/u2042od599191.jpg' }
                ],
                creator: 'Ken Wakui (Manga)', 
                studio: 'Liden Films',
                type: 'TV Series', 
                EPs: 50, // 24 (S1) + 13 (S2) + 13 (S3)
                genres: ['Action', 'Sci-Fi', 'Drama', 'School', 'Shonen', 'Time Travel'],
                duration: '24 min', 
                rating: 7.7, // Placeholder rating
                description: "Takemichi Hanagaki, a 26-year-old freeter, learns that his middle school ex-girlfriend, Hinata Tachibana, and her younger brother, Naoto, have been murdered by the ruthless Tokyo Manji Gang. After a near-death experience, Takemichi suddenly travels 12 years back in time to his middle school days. To save Hinata and to change his miserable adult life, the hopeless Takemichi resolves to infiltrate the Tokyo Manji Gang and climb its ranks. The story covers the Toman, Moebius, Valhalla, Christmas Showdown, and Tenjiku Arcs.",
                audience: 'Fans of emotional and high-stakes delinquent-themed action with a core focus on time-travel and friendship. Ideal for those who enjoy protagonists who grow through hardship and who appreciate intense gang rivalries.',
                coverImage: 'https://m.media-amazon.com/images/M/MV5BNGU3YzdhMWEtMGRkMC00MzY2LThkOGEtMDFmZDE0NGQxYzFjXkEyXkFqcGc@._V1_.jpg', 
                bgImage: 'https://img2.hulu.com/user/v3/artwork/1a195a35-e19c-4e36-b609-3b1c451f6ce4?base_image_bucket_name=image_manager&base_image=82eb61e7-9237-44c3-9c08-ce918ec4d79e&region=US&format=webp&size=952x536', 
                releaseYear: 2021, // First season release year
                trailer_url: 'https://www.youtube.com/embed/n4yBwD_n_F4', // Official Trailer Placeholder
                official_streams: [
                    { platform: 'Crunchyroll', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Crunchyroll.svg/1024px-Crunchyroll.svg.png' }, // S1
                    { platform: 'Disney+', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Disney%2B_logo.svg/1200px-Disney%2B_logo.svg.png' }, // S2 & S3
                    { platform: 'Hulu', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Hulu_logo_%282018%29.svg/1200px-Hulu_logo_%282018%29.svg.png' }, // S2 & S3 in US
                    { platform: 'Netflix', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png' } //
                ],
                gallery: [
                    'https://static0.colliderimages.com/wordpress/wp-content/uploads/2024/01/tokyo-revengers.jpg?w=1600&h=900&fit=crop',
                    'https://img.etimg.com/thumb/width-1600,height-900,imgsize-525003,resizemode-75,msid-105132774/news/international/us/tokyo-revengers-season-3-episode-7-global-release-schedule-and-expectations.jpg',
                    'https://a.storyblok.com/f/178900/1920x1080/75960d0d56/tokyo-revengers-tenjiku-arc-mikey.png',
                    'https://www.animesenpai.net/wp-content/uploads/2023/11/F_s4bQ5asAEJV5-.jpg.webp',
                    'https://pbs.twimg.com/media/F_s4aR8boAA0cy9.jpg',
                    'https://attackofthefanboy.com/wp-content/uploads/2023/11/Toman-ready-to-fight.jpg?w=1200'
                ]
            };

            // --- EP DATA: Tokyo Revengers S1-S3 (50 EPs total) ---
            const episodeData = [
                // Season 1 (24 Episodes: Toman/Moebius/Valhalla Arcs)
                { number: 1, title: 'EP 1: Reborn', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=1', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 2, title: 'EP 2: Resist', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=2', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 3, title: 'EP 3: Resolve', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=3', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 4, title: 'EP 4: Return', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=4', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 5, title: 'EP 5: Releap', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=5', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 6, title: 'EP 6: Regret', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=6', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 7, title: 'EP 7: Revive', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=7', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 8, title: 'EP 8: Rechange', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=8', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 9, title: 'EP 9: Revolt', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=9', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 10, title: 'EP 10: Rerise', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=10', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 11, title: 'EP 11: Respect', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=11', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 12, title: 'EP 12: Revenge', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=12', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 13, title: 'EP 13: Odds and Ends', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=13', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 14, title: 'EP 14: Break up', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=14', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 15, title: 'EP 15: No Pain, No Gain', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=15', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 16, title: 'EP 16: Once Upon a Time', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=16', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 17, title: 'EP 17: No Way', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=17', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 18, title: 'EP 18: Open Fire', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=18', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 19, title: 'EP 19: Turn Around', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=19', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 20, title: 'EP 20: Dead or Alive', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=20', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 21, title: 'EP 21: One and Only', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=21', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 22, title: 'EP 22: One for All', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=22', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 23, title: 'EP 23: End of War', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=23', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 24, title: 'EP 24: A Crybaby', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=1&e=24', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },

                // Season 2: Christmas Showdown Arc (13 Episodes, #25-37)
                { number: 25, title: 'EP 25: It is what it is', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=1', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 26, title: 'EP 26: Strive and survive', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=2', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 27, title: 'EP 27: Stand alone', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=3', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 28, title: 'EP 28: Family affair', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=4', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 29, title: 'EP 29: Whip up mercy', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=5', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 30, title: 'EP 30: Getting even', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=6', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 31, title: 'EP 31: Sins of the flesh', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=7', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 32, title: 'EP 32: The two of a kind', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=8', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 33, title: 'EP 33: Dawning of a New Era', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=9', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 34, title: 'EP 34: The Light of My Life', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=10', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 35, title: 'EP 35: On My Way Home', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=11', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 36, title: 'EP 36: Last Order', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=12', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 37, title: 'EP 37: Endless fight', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=2&e=13', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },

                // Season 3: Tenjiku Arc (13 Episodes, #38-50)
                { number: 38, title: 'EP 38: The returnee', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=1', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 39, title: 'EP 39: The bestest way', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=2', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 40, title: 'EP 40: Run out of patience', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=3', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 41, title: 'EP 41: Come back to life', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=4', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 42, title: 'EP 42: A bad hunch', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=5', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 43, title: 'EP 43: Nothing ventured, nothing gained', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=6', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 44, title: 'EP 44: Ignorance is bliss', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=7', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 45, title: 'EP 45: The only way', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=8', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 46, title: 'EP 46: The world is full of sadness', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=9', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 47, title: 'EP 47: The war of the top', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=10', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 48, title: 'EP 48: I will never surrender', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=11', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 49, title: 'EP 49: You always follow me', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=12', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 50, title: 'EP 50: The longest day', videoUrl: 'https://multiembed.mov/?video_id=tt13196080&s=3&e=13', thumbnail: 'https://m.media-amazon.com/images/M/MV5BOGM3OThkZTItMTQzYS00NjlhLThlYTItY2Q2ZTQ3ZjczNjU5XkEyXkFqcGc@._V1_.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }
            ];
            
            // --- Page Elements ---
            const videoPlayer = document.getElementById('video-player-iframe');
            const episodesListContainer = document.getElementById('episodes-list-container');
            const downloadLinksTbody = document.getElementById('download-links-tbody');
            const currentEpisodeTitle = document.getElementById('current-episode-title');
            const prevBtn = document.getElementById('prev-ep-btn');
            const nextBtn = document.getElementById('next-ep-btn');

            // --- Button Elements ---
            const playButton = document.getElementById('play-button');
            const mobilePlayButton = document.getElementById('mobile-play-button');
            const trailerButton = document.getElementById('trailer-button');
            const mobileTrailerButton = document.getElementById('mobile-trailer-button');
            const addToWatchlistBtn = document.getElementById('add-to-watchlist-btn');

            let currentEpisodeIndex = 0; // Index starting at 0
            const totalEpisodes = episodeData.length;

            function populateReviewSection() {
                // --- Review Population Logic ---
                document.title = `Review & Watch ${selectedAnime.title} - Anikan`;
                document.getElementById('hero-banner-section').style.backgroundImage = `url('${selectedAnime.bgImage}')`;
                document.getElementById('anime-title-main').textContent = selectedAnime.title;
                document.getElementById('hero-meta-year').textContent = selectedAnime.releaseYear;
                document.getElementById('hero-meta-type').textContent = selectedAnime.type;
                document.getElementById('hero-meta-duration').textContent = `${selectedAnime.duration}`;
                document.getElementById('anime-poster').src = selectedAnime.coverImage;
                document.getElementById('info-title').textContent = selectedAnime.title;
                document.getElementById('info-cast').textContent = selectedAnime.cast.join(', ');
                document.getElementById('info-creator').textContent = selectedAnime.creator;
                document.getElementById('info-genre').textContent = selectedAnime.genres.join(', ');
                const ratingCircle = document.getElementById('rating-circle');
                document.getElementById('rating-score').textContent = selectedAnime.rating;
                if (ratingCircle) {
                    ratingCircle.style.setProperty('--rating-percent', selectedAnime.rating * 10);
                }
                document.getElementById('synopsis-text').textContent = selectedAnime.description;
                // Using an imgur CDN link for the high-quality images
                document.getElementById('photos-grid').innerHTML = selectedAnime.gallery.map(img => `<img src="${img}" alt="Gallery image">`).join('');
                document.getElementById('trailer-player').src = selectedAnime.trailer_url;
                document.getElementById('character-list').innerHTML = selectedAnime.characters.map(char =>
                    `<div class="character-card"><img src="${char.image}" alt="${char.name}"><h4>${char.name}</h4></div>`
                ).join('');
                document.getElementById('anime-audience').textContent = selectedAnime.audience;
                const officialStreamsContainer = document.getElementById('official-streams');
                officialStreamsContainer.innerHTML = selectedAnime.official_streams.map(stream =>
                    `<a href="#" class="stream-logo"><img src="${stream.logo}" alt="${stream.platform}"></a>`
                ).join('');
                
                // Populate Sidebar Info
                document.getElementById('sidebar-poster').src = selectedAnime.coverImage;
                document.getElementById('sidebar-title').textContent = selectedAnime.title;
                document.getElementById('sidebar-type').textContent = selectedAnime.type;
                document.getElementById('sidebar-episodes').textContent = selectedAnime.EPs;
                document.getElementById('sidebar-duration').textContent = selectedAnime.duration;
                document.getElementById('sidebar-studio').textContent = selectedAnime.studio;
                document.getElementById('sidebar-score').textContent = selectedAnime.rating + '/10';
                document.getElementById('sidebar-genres').textContent = selectedAnime.genres.join(', ');
            }
            
            // --- NEW LOGIC: Using episodeData constant ---

            function updateUI(episodeIndex) {
                currentEpisodeIndex = parseInt(episodeIndex, 10);
                const episode = episodeData[currentEpisodeIndex];
                
                if (!episode) return;
                
                const episodeNumber = episode.number;
                // Use regex to get the part of the title after the number/colon for cleaner display in the H1
                const displayTitle = episode.title.match(/(?::\s?)(.*)/)?.[1] || episode.title;
                
                // Adjust title to reflect season structure
                let seasonPrefix = '';
                if (episodeNumber <= 24) {
                    seasonPrefix = 'S1';
                } else if (episodeNumber <= 37) {
                    seasonPrefix = 'S2: Christmas Showdown';
                } else {
                    seasonPrefix = 'S3: Tenjiku Arc';
                }

                currentEpisodeTitle.textContent = `${seasonPrefix} | Episode ${episodeNumber} - ${displayTitle}`;
                
                // 1. Update Video Player
                videoPlayer.src = episode.videoUrl;

                // 2. Update Download Links
                downloadLinksTbody.innerHTML = '';
                const downloadQualities = Object.keys(episode.downloads);
                const subtitleUrl = episode.subtitleUrl || '#';
                
                if (downloadQualities.length > 0) {
                     downloadQualities.forEach(quality => {
                        const downloadUrl = episode.downloads[quality];
                        downloadLinksTbody.innerHTML += `
                            <tr>
                                <td data-label="Episode">Episode ${episodeNumber}</td>
                                <td data-label="Quality">${quality}</td>
                                <td data-label="Video"><a href="${downloadUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-download"></i> Download</a></td>
                                <td data-label="Subtitles"><a href="${subtitleUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-closed-captioning"></i> Download</a></td>
                            </tr>`;
                    });
                } else {
                    downloadLinksTbody.innerHTML = `<tr><td colspan="4" style="text-align: center; color: var(--color-text-muted);">Download links not available for this episode.</td></tr>`;
                }
                
                // 3. Update Episode List Active State and scroll
                episodesListContainer.querySelectorAll('.episode-item').forEach(link => link.classList.remove('current'));
                const activeEpisodeLink = episodesListContainer.querySelector(`.episode-item[data-episode='${episodeNumber}']`);
                if (activeEpisodeLink) {
                    activeEpisodeLink.classList.add('current');
                    activeEpisodeLink.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }

                // 4. Update Navigation Buttons
                prevBtn.disabled = episodeNumber === 1;
                nextBtn.disabled = episodeNumber === totalEpisodes;
            }

            function generateEpisodeList() {
                episodesListContainer.innerHTML = '';
                episodeData.forEach((ep, index) => {
                    const episodeNumber = ep.number;
                    const episodeTitle = ep.title.match(/(?::\s?)(.*)/)?.[1] || ep.title; // Clean up title for display
                    
                    // Determine season label for display
                    let seasonLabel = '';
                    if (episodeNumber === 1) {
                        seasonLabel = '<span class="season-label">Season 1: Toman Arc</span>';
                    } else if (episodeNumber === 25) {
                        seasonLabel = '<span class="season-label">Season 2: Christmas Showdown Arc</span>';
                    } else if (episodeNumber === 38) {
                        seasonLabel = '<span class="season-label">Season 3: Tenjiku Arc</span>';
                    }


                    const itemHTML = `
                        ${seasonLabel}
                        <a class="episode-item" data-episode="${episodeNumber}" data-episode-index="${index}">
                            <img src="${ep.thumbnail}" alt="Ep ${episodeNumber}" class="episode-thumbnail">
                            <div class="ep-info">
                                <p class="ep-number">Episode ${episodeNumber}</p>
                                <p class="ep-desc">${episodeTitle}</p>
                            </div>
                        </a>
                    `;
                    episodesListContainer.innerHTML += itemHTML;
                });
                
                // Attach click listeners to the generated list items
                episodesListContainer.querySelectorAll('.episode-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        updateUI(item.dataset.episodeIndex);
                    });
                });
            }


            // --- Event Handlers ---
            const handlePlayClick = () => {
                document.body.classList.add('watching-active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                generateEpisodeList(); // Generate list and attach click handlers
                
                // Initialize the player with the first EP
                if (episodeData.length > 0) {
                    updateUI(0);
                }
            };
            
            const handleTrailerClick = () => {
                const trailerElement = document.getElementById('trailer-player');
                if (trailerElement) {
                    trailerElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };
            
            const handleAddToWatchlist = async () => {
                // Placeholder logic as in original
                const username = null; // Assuming no user is logged in
                if (!username) {
                    alert('Please log in to add to your watchlist.');
                    // window.location.href = '/login.html';
                    return;
                }
            };

            // --- Navigation Event Listeners ---
            prevBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex > 0) updateUI(currentEpisodeIndex - 1); 
            });
            nextBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex < totalEpisodes - 1) updateUI(currentEpisodeIndex + 1); 
            });

            // --- Other Event Listeners ---
            playButton.addEventListener('click', handlePlayClick);
            mobilePlayButton.addEventListener('click', handlePlayClick);
            trailerButton.addEventListener('click', handleTrailerClick);
            mobileTrailerButton.addEventListener('click', handleTrailerClick);
            addToWatchlistBtn.addEventListener('click', handleAddToWatchlist);

            // --- Initialize Page ---
            populateReviewSection();
        });
    </script>
</body>
</html>