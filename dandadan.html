<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review & Watch DanDaDan - Anikan</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* --- DanDaDan Watch Page Styles --- */
        :root {
            --color-background: #100f14;
            --color-card: #1c1b22;
            --color-text: #e0e0e0;
            --color-text-muted: #a0a0a0;
            --color-primary: #9D4EDD;
            --color-primary-light: #c77dff;
            --font-family: 'Poppins', sans-serif;
            --rating-color: #57D64B; /* Green for rating */
            --border-color: #2c2c34;
            /* Added for Watch Section */
            --primary-color: #9D4EDD;
            --primary-color-rgb: 157, 78, 221;
            --surface-color-darker: #1A1A1D;
            --surface-color-lighter: #2a2a2d;
            --background-color-watch: #0B0C10; 
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { background-color: var(--color-background); color: var(--color-text); font-family: var(--font-family); }
        a { color: var(--color-text); text-decoration: none; }
        img { max-width: 100%; display: block; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .widget {
            background: linear-gradient(180deg, var(--surface-color-lighter), var(--surface-color-darker));
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-radius: 8px; margin-bottom: 20px; padding: 20px;
        }
        .widget-title {
            font-size: 1.2rem; font-weight: 600; margin-bottom: 15px;
            padding-bottom: 10px; border-bottom: 1px solid var(--border-color);
        }

        .main-header {
            position: sticky;
            top: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            z-index: 1000;
            background-color: rgba(16,15,20,0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
        }
        .main-header .logo { font-size: 1.8rem; font-weight: 700; color: #fff; }
        .main-header .logo span { color: var(--color-primary); }
        .main-header .nav-links a { margin-left: 2rem; color: var(--color-text-muted); font-weight: 500; transition: color 0.3s ease; }
        .main-header .nav-links a:hover { color: var(--color-primary); }
        .main-header .search-bar { position: relative; display: none; } /* Hidden for simplicity */
        .main-header .user-profile { margin-left: 1.5rem; display: none; } /* Hidden for simplicity */


        /* --- Review Page Layout --- */
        .review-wrapper { transition: opacity 0.4s ease, visibility 0.4s ease; }
        .watch-section { display: none; opacity: 0; transition: opacity 0.4s ease; background-color: var(--background-color-watch);}
        body.watching-active .review-wrapper { display: none; opacity: 0; visibility: hidden; }
        body.watching-active .watch-section { display: block; opacity: 1; padding: 2rem 5%; }

        .hero-banner {
            position: relative;
            background-size: cover;
            background-position: center;
            height: 90vh;
            display: flex;
            align-items: flex-end;
            padding: 0 5% 3rem;
        }
        .hero-banner::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to top, var(--color-background) 0%, transparent 50%);
            z-index: 1;
        }
        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }
        .hero-content h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            max-width: 800px;
        }
        .hero-meta {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            font-size: 1rem;
            color: var(--color-text-muted);
            margin-bottom: 1.5rem;
        }
        .btn {
            padding: 0.8rem 2rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn:hover { transform: translateY(-3px); }
        .btn-primary { background-color: var(--color-primary); color: #fff; }
        .btn-secondary { background-color: rgba(255,255,255,0.15); color: #fff; }
        .hero-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .mobile-hero-buttons {
            display: none; /* Hidden by default */
        }

        .review-main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 5%;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 3rem;
            align-items: flex-start;
        }

        .left-sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        .movie-poster {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .watchlist-section {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            align-items: center;
        }
        .watchlist-section button {
            background-color: rgba(255,255,255,0.1);
            color: #fff;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: 500;
            font-size: 0.95rem;
            border: 1px solid rgba(255,255,255,0.2);
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .watchlist-section button:hover { background-color: rgba(255,255,255,0.2); }
        .watchlist-section button.added, .btn.added {
            background-color: var(--rating-color);
            border-color: var(--rating-color);
            cursor: not-allowed;
            color: #fff;
        }
        .user-rating-stars {
            font-size: 1.8rem;
            color: var(--color-text-muted);
            cursor: pointer;
            display: flex;
            gap: 0.5rem;
        }
        .user-rating-stars .fas { color: gold; }


        .info-panel {
            background-color: var(--color-card);
            border-radius: 12px;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .info-details ul { list-style: none; padding: 0;}
        .info-details li { margin-bottom: 0.8rem; color: var(--color-text-muted); display: flex;}
        .info-details li strong { color: var(--color-text); display: inline-block; min-width: 80px; margin-right: 10px;}
        .info-details li span { flex: 1; }

        .info-rating-circle {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .rating-circle-bg {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: grid;
            place-items: center;
            background: conic-gradient(var(--rating-color) calc(var(--rating-percent, 0) * 1%), var(--border-color) 0);
            margin-bottom: 0.5rem;
        }
        .rating-circle-inner {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--color-card);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .rating-score { font-size: 2.5rem; font-weight: 700; }
        .rating-max { font-size: 0.9rem; color: var(--color-text-muted); }
        .personal-rating-note { font-size: 0.8rem; color: var(--color-text-muted); margin-top: 0.5rem; }


        .section-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 1.5rem; color: #fff; }

        .synopsis-panel {
            margin-bottom: 2rem;
            background-color: var(--color-card);
            padding: 2rem;
            border-radius: 12px;
        }
        .synopsis-panel p { line-height: 1.8; color: var(--color-text-muted); }

        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .photos-grid img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.2s ease;
        }
        .photos-grid img:hover { transform: scale(1.03); }

        .trailer-panel .player-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            background-color: #000;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 2rem;
        }
        .trailer-panel .player-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .official-stream-grid {
            display: flex;
            align-items: center;
            gap: 2rem;
            flex-wrap: wrap;
            background-color: var(--color-card);
            padding: 2rem;
            border-radius: 12px;
        }
        .official-stream-grid .stream-logo img {
            height: 35px;
            width: auto;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        .official-stream-grid .stream-logo:hover img {
            opacity: 1;
        }

        .characters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .character-card {
            background-color: var(--color-background);
            border-radius: 8px;
            overflow: hidden;
            text-align: center;
            padding-bottom: 1rem;
        }
        .character-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 0.8rem;
        }
        .character-card h4 { font-size: 1rem; margin-bottom: 0.2rem; }
        .character-card p { font-size: 0.85rem; color: var(--color-text-muted); }
        
        /* --- Watch Section (Hoteldelluna/Gachiakuta Style) --- */
        .watch-layout { 
            display: grid; 
            grid-template-columns: 2fr 1fr; 
            gap: 20px; 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 2rem 0; /* Adjusted padding within the section */
        }
        .main-content-col { min-width: 0; }
        .video-player-container {
            position: relative;
            width: 100%;
            background-color: #000;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 16 / 9;
            border: 2px solid var(--border-color);
            margin-bottom: 20px;
        }
        
        #video-player-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .episode-meta { padding: 0 0 15px 0; }
        .episode-title-watch { font-size: 1.5rem; font-weight: 600; margin-bottom: 15px; }
        .episode-actions { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }

        .action-btn, .download-btn {
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-weight: 500;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .action-btn:hover:not(:disabled), .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }
        .action-btn:disabled {
            background-color: #222;
            color: #555;
            cursor: not-allowed;
        }
        .action-btn {
            background: linear-gradient(180deg, #4a4a52, #313136);
            color: var(--color-text);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .action-btn:hover:not(:disabled) {
            background: linear-gradient(180deg, #5a5a62, #414146);
        }

        #next-ep-btn {
            background: linear-gradient(180deg, #ffffff, #e0e0e0);
            color: #0B0C10;
            box-shadow: 0 2px 5px rgba(255, 255, 255, 0.1);
        }
        .download-btn {
            background: linear-gradient(180deg, hsl(270, 77%, 60%), hsl(270, 77%, 50%)); /* Adjusted to primary color */
            color: white;
            box-shadow: 0 2px 8px rgba(var(--primary-color-rgb), 0.25);
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        .download-btn:hover {
             background: linear-gradient(180deg, hsl(270, 77%, 65%), hsl(270, 77%, 55%));
        }

        /* --- Episode List / Downloads --- */
        .episodes-list-widget .episodes-list { max-height: 400px; overflow-y: auto; padding-right: 10px; list-style: none; }
        .episode-item { display: flex; align-items: center; gap: 15px; padding: 10px; border-radius: 5px; margin-bottom: 5px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s ease; }
        .episode-item:hover { background-color: var(--surface-color-lighter); border-color: var(--border-color); }
        .episode-item.current { background: rgba(var(--primary-color-rgb), 0.1); border-color: var(--primary-color); }
        .episode-item .ep-number { font-weight: 600; font-size: 1.1rem; }
        .episode-item .ep-desc { font-size: 0.9rem; color: var(--color-text-muted); }
        .episode-thumbnail-small { width: 70px; height: 40px; object-fit: cover; border-radius: 4px; flex-shrink: 0; }

        .download-list table { width: 100%; border-collapse: collapse; }
        .download-list th, .download-list td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-color); }
        .download-list th { color: var(--color-text-muted); font-weight: 500; }
        
        /* Sidebar Placeholder */
        .drama-info-widget { padding: 20px; }
        .info-title-sidebar { font-size: 1.5rem; font-weight: 600; margin-bottom: 10px; }
        .info-details p { font-size: 0.9rem; padding: 8px 0; border-bottom: 1px solid var(--border-color); }
        .info-details p:last-child { border-bottom: none; }
        .info-details span { color: var(--color-text-muted); display: inline-block; width: 110px; }
        .info-poster img { border-radius: 8px; margin-bottom: 15px; }

        /* Responsive Styles (Adapted) */
        @media (max-width: 992px) { 
            .watch-layout { grid-template-columns: 1fr; } 
            .episode-title-watch { font-size: 1.4rem; } 
            .watch-section { padding: 15px; }
        }
        @media (max-width: 576px) { 
            .watch-section { padding: 10px; }
            .episode-title-watch { font-size: 1.2rem; }
            .download-list thead { display: none; } 
            .download-list tr { display: block; border-bottom: 2px solid var(--primary-color); margin-bottom: 15px; padding-bottom: 15px; } 
            .download-list tr:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; } 
            .download-list td { display: block; text-align: right; font-size: 0.9rem; border-bottom: none; padding: 5px 8px; position: relative; } 
            .download-list td::before { content: attr(data-label); position: absolute; left: 8px; font-weight: bold; color: var(--color-text-muted); text-align: left; } 
            .action-btn { padding: 6px 12px; font-size: 0.9rem; } 
        }
    </style>
</head>
<body>

    <header class="main-header">
        <a href="home.html" class="logo">Ani<span>kan</span></a>
        <nav class="nav-links">
            <a href="home.html">Home</a>
            <a href="movies.html">Movies</a>
            <a href="categories.html">Genre</a>
        </nav>
    </header>

    <main>
        <div class="review-wrapper" id="review-wrapper">
            <section class="hero-banner" id="hero-banner-section">
                <div class="hero-content">
                    <h1 id="anime-title-main"></h1>
                    <div class="hero-meta">
                        <span id="hero-meta-year"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-type"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-duration"></span>
                    </div>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                </div>
            </section>
            
            <div class="review-main-content">
                <div class="left-sidebar">
                    <img id="anime-poster" class="movie-poster" src="" alt="Anime Poster">
                    
                    <div class="mobile-hero-buttons">
                        <button class="btn btn-primary" id="mobile-play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="mobile-trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                    
                    <div class="watchlist-section">
                        <button id="add-to-watchlist-btn"><i class="fas fa-plus"></i> Add to Watchlist</button>
                        <div class="user-rating-stars" id="user-rating-stars">
                        </div>
                    </div>
                </div>

                <div>
                    <div class="info-panel">
                        <div class="info-details">
                            <ul>
                                <li><strong>Title:</strong> <span id="info-title"></span></li>
                                <li><strong>Cast:</strong> <span id="info-cast"></span></li>
                                <li><strong>Creator:</strong> <span id="info-creator"></span></li>
                                <li><strong>Genre:</strong> <span id="info-genre"></span></li>
                            </ul>
                        </div>
                        <div class="info-rating-circle">
                            <div class="rating-circle-bg" id="rating-circle">
                                <div class="rating-circle-inner">
                                    <span class="rating-score" id="rating-score"></span>
                                    <span class="rating-max">out of 10</span>
                                </div>
                            </div>
                            <p class="personal-rating-note">note: personal rating only</p>
                        </div>
                    </div>

                    <div class="synopsis-panel">
                        <h2 class="section-title">Synopsis</h2>
                        <p id="synopsis-text"></p>
                    </div>

                    <h2 class="section-title">Photos</h2>
                    <div class="photos-grid" id="photos-grid"></div>

                    <h2 class="section-title">Official Trailer</h2>
                    <div class="trailer-panel">
                        <div class="player-container">
                            <iframe id="trailer-player" src="" title="Official Trailer Player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
                         </div>
                    </div>

                    <h2 class="section-title">Main Characters</h2>
                    <div class="characters-grid" id="character-list"></div>

                    <h2 class="section-title">Who is this Anime for?</h2>
                    <div class="synopsis-panel">
                        <p id="anime-audience"></p>
                    </div>

                    <h2 class="section-title">Where to Watch Officially</h2>
                    <div class="official-stream-grid" id="official-streams"></div>
                </div>
            </div>
        </div>
        
        <section class="watch-section" id="watch-section">
            <div class="watch-layout" id="watch-layout">
                <div class="main-content-col">
                    <div class="video-player-container">
                        <iframe 
                            id="video-player-iframe"
                            src="" 
                            title="Video Player" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen>
                        </iframe>
                    </div>

                    <div class="episode-meta">
                        <h1 class="episode-title-watch" id="current-episode-title"></h1>
                        <div class="episode-actions">
                            <button class="action-btn" id="prev-ep-btn"><i class="fas fa-arrow-left"></i>Prev</button>
                            <button class="action-btn" id="next-ep-btn">Next<i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <div class="widget episodes-list-widget">
                        <h2 class="widget-title">Episodes</h2>
                        <div class="episodes-list" id="episodes-list-container">
                            </div>
                    </div>
                    
                    <div class="widget download-widget">
                        <h2 class="widget-title">Download (Placeholder Links)</h2>
                        <div class="download-list">
                            <table>
                                <thead>
                                    <tr><th>Episode</th><th>Quality</th><th>Video</th><th>Subtitles</th></tr>
                                </thead>
                                <tbody id="download-links-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="sidebar-col">
                    <div class="widget drama-info-widget">
                        <div class="info-poster"><img id="sidebar-poster" src="" alt="Anime Poster"></div>
                        <h2 class="info-title-sidebar" id="sidebar-title"></h2>
                        <div class="info-details">
                            <p><span>Type:</span> <span id="sidebar-type"></span></p>
                            <p><span>Episodes:</span> <span id="sidebar-episodes"></span></p>
                            <p><span>Duration:</span> <span id="sidebar-duration"></span></p>
                            <p><span>Studio:</span> <span id="sidebar-studio"></span></p>
                            <p><span>Score:</span> <span id="sidebar-score"></span></p>
                            <p><span>Genres:</span> <span id="sidebar-genres"></span></p>
                        </div>
                    </div>
                    <div class="widget recommendations-widget">
                        <h2 class="widget-title">You Might Also Like</h2>
                        <div class="recommendations-list">
                           <p style="color: var(--color-text-muted); font-size: 0.9rem;">Recommendation list placeholder.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Data: DanDaDan for the review page (Base) ---
            const selectedAnime = {
                id: 4, title: 'DanDaDan', title_japanese: 'ダンダダン',
                cast: ['Momo Ayase (Shion Wakayama)', 'Ken "Okarun" Takakura (Natsuki Hanae)', 'Turbo Granny (Mayumi Tanaka)', 'Serpoian (Kazuya Nakai)'],
                characters: [
                    { name: 'Momo Ayase', image: 'https://static.wikia.nocookie.net/dandadan/images/c/ce/Momo_Ayase_Anime_Infobox_2.png/revision/latest?cb=20241116233954' },
                    { name: 'Ken Takakura', image: 'https://static.wikia.nocookie.net/dandadan/images/e/e0/Okarun_Anime_Infobox_2.png/revision/latest?cb=20241218045003' },
                    { name: 'Turbo Granny', image: 'https://static.wikia.nocookie.net/dandadan/images/8/84/Turbo_Granny_%28Doll%29_Infobox_%28Anime%29.png/revision/latest?cb=20241031174232' }
                ],
                creator: 'Yukinobu Tatsu (Manga)', studio: 'Science SARU', type: 'TV Series',
                genres: ['Action', 'Sci-Fi', 'Comedy', 'Supernatural'],
                duration: '24 min', rating: 8.9,
                description: 'Momo Ayase is a high schooler who believes in ghosts but denies the existence of aliens, while her classmate, Okarun, believes in aliens but denies ghosts. To settle the matter, they dare each other to visit places linked to their opposing beliefs. But when they both turn out to be right, they get caught in the crossfire of the supernatural and extraterrestrial. Cursed and gifted with strange new powers, they must team up to fight off a bizarre onslaught of aliens, ghosts, and cryptids, all while navigating a budding, chaotic romance.',
                audience: 'Fans of hyperactive action-comedy with a unique blend of sci-fi and the occult will love DanDaDan. If you enjoy the wild energy and heartfelt character dynamics of shows like "Chainsaw Man" or "Mob Psycho 100," this series is a must-watch for its incredible animation, off-the-wall humor, and non-stop paranormal battles.',
                coverImage: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg',
                bgImage: 'https://static0.cbrimages.com/wordpress/wp-content/uploads/2025/06/c4ee60d3-5d74-4dc0-a663-1e56ad42e02f.jpeg',
                releaseYear: 2024,
                trailer_url: 'https://youtu.be/uXr9Ha9qRHE?si=EDb1B8fYMZxbhxQx',
                official_streams: [
                    { platform: 'Crunchyroll', logo: 'https://cdn.worldvectorlogo.com/logos/crunchyroll-1.svg' },
                    { platform: 'Netflix', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png' },
                    { platform: 'Amazon Prime Video', logo: 'https://m.media-amazon.com/images/G/03/digital/video/acquisition/logo/pv_logo_white._CB548648733_.png' }
                ],
                gallery: [
                    'https://staticg.sportskeeda.com/editor/2025/08/3eeb1-17552362751704-1920.jpg?w=640',
                    'https://comicbook.com/wp-content/uploads/sites/4/2025/04/dandadan-Season-2-Okarun.jpeg',
                    'https://media.butwhytho.net/wp-content/uploads/2025/09/DanDaDan-Season-2-But-Why-Tho-1.jpg',
                    'https://static.beebom.com/wp-content/uploads/2024/12/Jiji-Momo-and-Okarun.jpg?w=1168&quality=75',
                    'https://media.butwhytho.net/wp-content/uploads/2025/09/DanDaDan-Season-2-Episode-12-But-Why-Tho.jpg',
                    'https://cdn.oneesports.gg/cdn-data/2024/12/Anime_Dandadan_EvilVillages_Episode12_Season1-1024x576.jpg'
                ],
                episodes: 24 // Total episodes
            };

            // Helper function for YouTube Embeds
            function getYouTubeEmbedUrl(url) {
                let videoId = null;
                const patterns = [
                    /(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})/,
                    /(?:https?:\/\/)?youtu\.be\/([a-zA-Z0-9_-]{11})/,
                    /(?:https?:\/\/)?(?:www\.)?youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/
                ];

                for (const pattern of patterns) {
                    const match = url.match(pattern);
                    if (match && match[1]) {
                        videoId = match[1];
                        break;
                    }
                }
                return videoId ? `https://www.youtube.com/embed/${videoId}` : url;
            }
            
            // --- SEPARATE EPISODE DATA CONSTANT (As requested, flat structure) ---
            const episodeData = [
                // Season 1 (1-12)
                { number: 1, title: 'Episode 1: Believe in Ghosts, Disbelieve in Aliens', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=1', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }, 
                { number: 2, title: 'Episode 2: The Curse of the Turbo Granny', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=2', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }, 
                { number: 3, title: 'Episode 3: The Jomon Alien', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=3', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 4, title: 'Episode 4: Battle for the Golden Balls', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=4', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 5, title: 'Episode 5: The Serpoian Rescue', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=5', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 6, title: 'Episode 6: Meeting the Evil Eye', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=6', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }, 
                { number: 7, title: 'Episode 7: The Cursed Tunnel', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=7', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 8, title: 'Episode 8: Momo’s Power Awakens', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=8', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 9, title: 'Episode 9: Okarun’s True Form', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=9', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 10, title: 'Episode 10: The Dinosaur Man', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=10', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 11, title: 'Episode 11: Teamwork vs. Cryptid', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=11', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 12, title: 'Episode 12: Farewell, Turbo Granny (S1 Finale)', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=1&e=12', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 13, title: 'Episode 13: Back to Battle', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=1', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 14, title: 'Episode 14: The Venusian', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=2', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 15, title: 'Episode 15: The Doppelgänger Threat', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=3', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 16, title: 'Episode 16: New Powers, New Enemies', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=4', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 17, title: 'Episode 17: The Alien Invasion Plan', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=5', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 18, title: 'Episode 18: Grandma\'s Return', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=6', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 19, title: 'Episode 19: The Secret of the Curse', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=7', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 20, title: 'Episode 20: Love Triangle of the Damned', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=8', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 21, title: 'Episode 21: Cosmic Horror Show', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=9', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 22, title: 'Episode 22: Unraveling the Mystery', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=10', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 23, title: 'Episode 23: Final Confrontation', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=11', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 24, title: 'Episode 24: New Adventures (Series Finale)', videoUrl: 'https://multiembed.mov/?video_id=tt30217403&s=2&e=12', thumbnail: 'https://images.justwatch.com/poster/330265270/s718/season-2.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }
            ];
            
            // --- Page Elements ---
            const videoPlayer = document.getElementById('video-player-iframe'); // ID change for new structure
            const episodesListContainer = document.getElementById('episodes-list-container'); // Container for list items
            const downloadLinksTbody = document.getElementById('download-links-tbody');
            const currentEpisodeTitle = document.getElementById('current-episode-title');
            const prevBtn = document.getElementById('prev-ep-btn');
            const nextBtn = document.getElementById('next-ep-btn');

            // --- Button Elements (from review page) ---
            const playButton = document.getElementById('play-button');
            const mobilePlayButton = document.getElementById('mobile-play-button');
            const trailerButton = document.getElementById('trailer-button');
            const mobileTrailerButton = document.getElementById('mobile-trailer-button');
            const addToWatchlistBtn = document.getElementById('add-to-watchlist-btn');

            let currentEpisodeIndex = 0; // Index starting at 0
            const totalEpisodes = episodeData.length;

            function populateReviewSection() {
                // Initial Population of Review Page UI
                document.title = `Review & Watch ${selectedAnime.title} - Anikan`;
                document.getElementById('hero-banner-section').style.backgroundImage = `url('${selectedAnime.bgImage}')`;
                document.getElementById('anime-title-main').textContent = selectedAnime.title;
                document.getElementById('hero-meta-year').textContent = selectedAnime.releaseYear;
                document.getElementById('hero-meta-type').textContent = selectedAnime.type;
                document.getElementById('hero-meta-duration').textContent = `${selectedAnime.duration}`;
                document.getElementById('anime-poster').src = selectedAnime.coverImage;
                document.getElementById('info-title').textContent = selectedAnime.title;
                document.getElementById('info-cast').textContent = selectedAnime.cast.join(', ');
                document.getElementById('info-creator').textContent = selectedAnime.creator;
                document.getElementById('info-genre').textContent = selectedAnime.genres.join(', ');
                const ratingCircle = document.getElementById('rating-circle');
                document.getElementById('rating-score').textContent = selectedAnime.rating;
                ratingCircle.style.setProperty('--rating-percent', selectedAnime.rating * 10);
                document.getElementById('synopsis-text').textContent = selectedAnime.description;
                document.getElementById('photos-grid').innerHTML = selectedAnime.gallery.map(img => `<img src="${img}" alt="Gallery image">`).join('');
                document.getElementById('trailer-player').src = getYouTubeEmbedUrl(selectedAnime.trailer_url);
                document.getElementById('character-list').innerHTML = selectedAnime.characters.map(char =>
                    `<div class="character-card"><img src="${char.image}" alt="${char.name}"><h4>${char.name}</h4></div>`
                ).join('');
                document.getElementById('anime-audience').textContent = selectedAnime.audience;
                const officialStreamsContainer = document.getElementById('official-streams');
                officialStreamsContainer.innerHTML = selectedAnime.official_streams.map(stream =>
                    `<a href="#" class="stream-logo"><img src="${stream.logo}" alt="${stream.platform}"></a>`
                ).join('');
                
                // Populate Sidebar Info
                document.getElementById('sidebar-poster').src = selectedAnime.coverImage;
                document.getElementById('sidebar-title').textContent = selectedAnime.title;
                document.getElementById('sidebar-type').textContent = selectedAnime.type;
                document.getElementById('sidebar-episodes').textContent = selectedAnime.episodes;
                document.getElementById('sidebar-duration').textContent = selectedAnime.duration;
                document.getElementById('sidebar-studio').textContent = selectedAnime.studio;
                document.getElementById('sidebar-score').textContent = selectedAnime.rating + '/10';
                document.getElementById('sidebar-genres').textContent = selectedAnime.genres.join(', ');
            }
            
            // --- WATCH UI LOGIC ---

            function updateUI(episodeIndex) {
                currentEpisodeIndex = parseInt(episodeIndex, 10);
                const episode = episodeData[currentEpisodeIndex];
                
                if (!episode) return;
                
                const episodeNumber = episode.number;
                const displayTitle = episode.title.match(/(?::\s?)(.*)/)?.[1] || episode.title; // Clean up title for display

                currentEpisodeTitle.textContent = `You are watching Episode ${episodeNumber} - ${displayTitle}`;
                
                // 1. Update Video Player
                videoPlayer.src = episode.videoUrl;

                // 2. Update Download Links
                downloadLinksTbody.innerHTML = '';
                const downloadQualities = Object.keys(episode.downloads);
                const subtitleUrl = episode.subtitleUrl || '#';
                
                if (downloadQualities.length > 0) {
                     downloadQualities.forEach(quality => {
                        const downloadUrl = episode.downloads[quality];
                        downloadLinksTbody.innerHTML += `
                            <tr>
                                <td data-label="Episode">Episode ${episodeNumber}</td>
                                <td data-label="Quality">${quality}</td>
                                <td data-label="Video"><a href="${downloadUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-download"></i> Download</a></td>
                                <td data-label="Subtitles"><a href="${subtitleUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-closed-captioning"></i> Download</a></td>
                            </tr>`;
                    });
                } else {
                    downloadLinksTbody.innerHTML = `<tr><td colspan="4" style="text-align: center; color: var(--color-text-muted);">Download links not available for this episode.</td></tr>`;
                }
                
                // 3. Update Episode List Active State and scroll
                episodesListContainer.querySelectorAll('.episode-item').forEach(link => link.classList.remove('current'));
                const activeEpisodeLink = episodesListContainer.querySelector(`.episode-item[data-episode='${episodeNumber}']`);
                if (activeEpisodeLink) {
                    activeEpisodeLink.classList.add('current');
                    activeEpisodeLink.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }

                // 4. Update Navigation Buttons
                prevBtn.disabled = episodeNumber === 1;
                nextBtn.disabled = episodeNumber === totalEpisodes;
            }

            function generateEpisodeList() {
                episodesListContainer.innerHTML = '';
                episodeData.forEach((ep, index) => {
                    const episodeNumber = ep.number;
                    const episodeTitle = ep.title.match(/(?::\s?)(.*)/)?.[1] || ep.title; // Clean up title for display
                    
                    const itemHTML = `
                        <a class="episode-item" data-episode="${episodeNumber}" data-episode-index="${index}">
                            <img src="${ep.thumbnail}" alt="Ep ${episodeNumber}" class="episode-thumbnail-small">
                            <div class="ep-info">
                                <p class="ep-number">E${episodeNumber}</p>
                                <p class="ep-desc">${episodeTitle}</p>
                            </div>
                        </a>
                    `;
                    episodesListContainer.innerHTML += itemHTML;
                });
                
                // Attach click listeners to the generated list items
                episodesListContainer.querySelectorAll('.episode-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        updateUI(item.dataset.episodeIndex);
                    });
                });
            }


            // --- Event Handlers ---
            const handlePlayClick = () => {
                document.body.classList.add('watching-active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                generateEpisodeList(); // Generate list and attach click handlers
                
                // Initialize the player with the first episode
                if (episodeData.length > 0) {
                    updateUI(0);
                }
            };
            
            const handleTrailerClick = () => {
                const trailerElement = document.getElementById('trailer-player');
                if (trailerElement) {
                    trailerElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };
            
            const handleAddToWatchlist = async () => {
                const username = localStorage.getItem('loggedInUser');
                if (!username) {
                    alert('Please log in to add to your watchlist.');
                    window.location.href = '/login.html';
                    return;
                }
            };

            // --- Navigation Event Listeners ---
            prevBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex > 0) updateUI(currentEpisodeIndex - 1); 
            });
            nextBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex < totalEpisodes - 1) updateUI(currentEpisodeIndex + 1); 
            });

            // --- Other Event Listeners ---
            playButton.addEventListener('click', handlePlayClick);
            mobilePlayButton.addEventListener('click', handlePlayClick);
            trailerButton.addEventListener('click', handleTrailerClick);
            mobileTrailerButton.addEventListener('click', handleTrailerClick);
            addToWatchlistBtn.addEventListener('click', handleAddToWatchlist);

            // --- Initialize Page ---
            populateReviewSection();
        });
    </script>
</body>
</html>