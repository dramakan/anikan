<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review & Watch Death Note - Anikan</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
    
    </head>
<body>

    <header class="main-header">
        <a href="home.html" class="logo">Ani<span>kan</span></a>
        <nav class="nav-links">
            <a href="home.html">Home</a>
            <a href="movies.html">Movies</a>
            <a href="categories.html">Genre</a>
        </nav>
        <div class="main-header .search-bar" style="display: none;">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search...">
        </div>
        <div class="main-header .user-profile" style="display: none;">
            <img src="profile.jpg" alt="User Profile">
        </div>
    </header>

    <main>
        <div class="review-wrapper" id="review-wrapper">
            <section class="hero-banner" id="hero-banner-section">
                <div class="hero-content">
                    <h1 id="anime-title-main"></h1>
                    <div class="hero-meta">
                        <span id="hero-meta-year"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-type"></span>
                        <span>&bull;</span>
                        <span id="hero-meta-duration"></span>
                    </div>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                </div>
            </section>
            
            <div class="review-main-content">
                <div class="left-sidebar">
                    <img id="anime-poster" class="movie-poster" src="" alt="Anime Poster">
                    
                    <div class="mobile-hero-buttons">
                        <button class="btn btn-primary" id="mobile-play-button"><i class="fas fa-play"></i>Watch</button>
                        <button class="btn btn-secondary" id="mobile-trailer-button"><i class="fas fa-film"></i> Trailer</button>
                    </div>
                    
                    <div class="watchlist-section">
                        <button id="add-to-watchlist-btn"><i class="fas fa-plus"></i> Add to Watchlist</button>
                        <div class="user-rating-stars" id="user-rating-stars">
                        </div>
                    </div>
                </div>

                <div>
                    <div class="info-panel">
                        <div class="info-details">
                            <ul>
                                <li><strong>Title:</strong> <span id="info-title"></span></li>
                                <li><strong>Cast:</strong> <span id="info-cast"></span></li>
                                <li><strong>Creator:</strong> <span id="info-creator"></span></li>
                                <li><strong>Genre:</strong> <span id="info-genre"></span></li>
                            </ul>
                        </div>
                        <div class="info-rating-circle">
                            <div class="rating-circle-bg" id="rating-circle">
                                <div class="rating-circle-inner">
                                    <span class="rating-score" id="rating-score"></span>
                                    <span class="rating-max">out of 10</span>
                                </div>
                            </div>
                            <p class="personal-rating-note">note: personal rating only</p>
                        </div>
                    </div>

                    <div class="synopsis-panel">
                        <h2 class="section-title">Synopsis</h2>
                        <p id="synopsis-text"></p>
                    </div>

                    <h2 class="section-title">Photos</h2>
                    <div class="photos-grid" id="photos-grid"></div>

                    <h2 class="section-title">Official Trailer</h2>
                    <div class="trailer-panel">
                        <div class="player-container">
                            <iframe id="trailer-player" src="" title="Official Trailer Player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
                         </div>
                    </div>

                    <h2 class="section-title">Main Characters</h2>
                    <div class="characters-grid" id="character-list"></div>

                    <h2 class="section-title">Who is this Anime for?</h2>
                    <div class="synopsis-panel">
                        <p id="anime-audience"></p>
                    </div>

                    <h2 class="section-title">Where to Watch Officially</h2>
                    <div class="official-stream-grid" id="official-streams"></div>
                </div>
            </div>
        </div>
        
        <section class="watch-section" id="watch-section">
            <div class="watch-layout" id="watch-layout">
                <div class="main-content-col">
                    <div class="video-player-container">
                        <iframe 
                            id="video-player-iframe"
                            src="" 
                            title="Video Player" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen>
                        </iframe>
                    </div>

                    <div class="episode-meta">
                        <h1 class="episode-title" id="current-episode-title"></h1>
                        <div class="episode-actions">
                            <button class="action-btn" id="prev-ep-btn"><i class="fas fa-arrow-left"></i>Prev</button>
                            <button class="action-btn" id="next-ep-btn">Next<i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <div class="widget episodes-list-widget">
                        <h2 class="widget-title">Episodes</h2>
                        <div class="episodes-list" id="episodes-list-container">
                        </div>
                    </div>
                    
                    <div class="widget download-widget">
                        <h2 class="widget-title">Download (Placeholder Links)</h2>
                        <div class="download-list">
                            <table>
                                <thead>
                                    <tr><th>Episode</th><th>Quality</th><th>Video</th><th>Subtitles</th></tr>
                                </thead>
                                <tbody id="download-links-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="sidebar-col">
                    <div class="widget drama-info-widget">
                        <div class="info-poster"><img id="sidebar-poster" src="" alt="Anime Poster"></div>
                        <h2 class="info-title-sidebar" id="sidebar-title"></h2>
                        <div class="info-details">
                            <p><span>Type:</span> <span id="sidebar-type"></span></p>
                            <p><span>Episodes:</span> <span id="sidebar-episodes"></span></p>
                            <p><span>Duration:</span> <span id="sidebar-duration"></span></p>
                            <p><span>Studio:</span> <span id="sidebar-studio"></span></p>
                            <p><span>Score:</span> <span id="sidebar-score"></span></p>
                            <p><span>Genres:</span> <span id="sidebar-genres"></span></p>
                        </div>
                    </div>
                    <div class="widget recommendations-widget">
                        <h2 class="widget-title">More from Anikan</h2>
                        <div class="recommendations-list">
                           <p style="color: var(--color-text-muted); font-size: 0.9rem;">Recommendation list placeholder.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Data: Death Note (Full Series) ---
            const selectedAnime = {
                id: 1, 
                title: 'Death Note', 
                title_japanese: 'デスノート',
                cast: ['Mamoru Miyano (Light Yagami)', 'Kappei Yamaguchi (L)', 'Shido Nakamura II (Ryuk)', 'Aya Hirano (Misa Amane)', 'Noriko Hidaka (Near)'], // Based on search results
                characters: [
                    { name: 'Light Yagami', image: 'https://tse2.mm.bing.net/th/id/OIP.i7w6wF-TG64WkoHpnl0KewHaFj?pid=Api&P=0&h=180' }, 
                    { name: 'L', image: 'https://tse4.mm.bing.net/th/id/OIP._t-L8EA7N1GTyQ731d894AHaEo?pid=Api&P=0&h=180' }, 
                    { name: 'Ryuk', image: 'https://tse1.mm.bing.net/th/id/OIP.dw85XixChTknd_eqGRcV8wHaEK?pid=Api&P=0&h=180' },
                    { name: 'Misa Amane', image: 'https://tse2.mm.bing.net/th/id/OIP.f6lruNvYgz9lJ14dZ3rsfQHaEK?pid=Api&P=0&h=180' } 
                ],
                creator: 'Tsugumi Ohba (Writer) & Takeshi Obata (Artist)', // Based on search results
                studio: 'Madhouse', // Based on search results
                type: 'TV Series', 
                EPs: 37, // Based on search results
                genres: ['Mystery', 'Supernatural', 'Thriller', 'Psychological', 'Crime', 'Dark Fantasy'], // Based on search results
                duration: '23 min', // Approximately, based on 22:57 - 23:00 runtimes
                rating: 8.9, // High rating placeholder
                description: "Light Yagami, an ace high school student, finds the 'Death Note,' a supernatural notebook dropped by the Shinigami Ryuk. The notebook grants its user the ability to kill anyone whose name is written in it while picturing their face. Light decides to use the Death Note to cleanse the world of criminals, becoming the vigilante 'Kira.' His actions draw the attention of L, the world's greatest detective, leading to an intense, high-stakes game of cat and mouse.", // Summarized plot
                audience: 'Viewers who enjoy intense psychological thrillers, cat-and-mouse games, moral and philosophical debates, and series with highly intelligent protagonists and antagonists. The show contains violence and is rated TV-14/UA16+.', // Audience based on genres and rating
                coverImage: 'https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fstatic1.cbrimages.com%2Fwordpress%2Fwp-content%2Fuploads%2Fsharedimages%2F2024%2F06%2Fdeath-note-2006.jpg&f=1&nofb=1&ipt=f38deb09a454c740d3cb44067d7bcd72f774ccb3816088f1636ad0eced7e3450', // Placeholder
                bgImage: 'https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fimages6.fanpop.com%2Fimage%2Fphotos%2F32400000%2FDeath-Note-death-note-32414092-3917-3000.jpg&f=1&nofb=1&ipt=e6c431b7842bce65dbb7b274cb48ff63aab5a93ed93f9bce84bf511b12f72dd1', // Placeholder
                releaseYear: 2006, // Based on original air dates
                trailer_url: 'https://www.youtube.com/embed/t_lH35iUu60', // Placeholder
                official_streams: [
                    { platform: 'Netflix', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png' }, // Available on Netflix
                    { platform: 'Hulu', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Hulu_logo_%282018%29.svg/1200px-Hulu_logo_%282018%29.svg.png' }, // Available on Hulu
                    { platform: 'Tubi', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Tubi_logo_2024_purple.svg/2560px-Tubi_logo_2024_purple.svg.png' }, // Available on Tubi
                    { platform: 'Crunchyroll', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Crunchyroll.svg/1024px-Crunchyroll.svg.png' } // Available on Crunchyroll in some regions
                ],
                gallery: [
                    'https://tse3.mm.bing.net/th/id/OIP.MrWg_mN0KdQCnpHQ_M6B5wHaFj?pid=Api&P=0&h=180', 
                    'https://tse2.mm.bing.net/th/id/OIP.04g2r0hM_x9uyR68D_ETswHaEK?pid=Api&P=0&h=180', 
                    'https://tse4.mm.bing.net/th/id/OIP.ZwrpgINNYSLk6P6lhcam2AHaEK?pid=Api&P=0&h=180', 
                    'https://tse3.mm.bing.net/th/id/OIP.Jwnn9d_VMALTCzghYRd7oQHaDt?pid=Api&P=0&h=180',
                    'https://tse3.mm.bing.net/th/id/OIP.D-yLjZzLLWpYZo73DiYkbQHaFj?pid=Api&P=0&h=180',
                    'https://tse2.mm.bing.net/th/id/OIP.r-bg2bFAblilz7ozFiS9jAHaDt?pid=Api&P=0&h=180'
                ]
            };

            // --- EPISODE DATA: Death Note (37 EPs total) ---
            // URLs and download links replaced with '#' to prevent copyright violation.
            const episodeData = [
                { number: 1, title: 'EP 1: Rebirth', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=1', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 2, title: 'EP 2: Confrontation', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=2', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 3, title: 'EP 3: Dealings', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=3', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 4, title: 'EP 4: Pursuit', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=4', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 5, title: 'EP 5: Tactics', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=5', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 6, title: 'EP 6: Unraveling', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=6', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 7, title: 'EP 7: Overcast', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=7', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 8, title: 'EP 8: Glare', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=8', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 9, title: 'EP 9: Encounter', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=9', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 10, title: 'EP 10: Doubt', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=10', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 11, title: 'EP 11: Assault', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=11', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 12, title: 'EP 12: Love', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=12', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 13, title: 'EP 13: Confession', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=13', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 14, title: 'EP 14: Friend', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=14', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 15, title: 'EP 15: Wager', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=15', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 16, title: 'EP 16: Decision', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=16', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 17, title: 'EP 17: Execution', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=17', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 18, title: 'EP 18: Ally', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=18', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 19, title: 'EP 19: Matsuda', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=19', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 20, title: 'EP 20: Makeshift', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=20', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 21, title: 'EP 21: Performance', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=21', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 22, title: 'EP 22: Guidance', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=22', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 23, title: 'EP 23: Frenzy', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=23', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 24, title: 'EP 24: Revival', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=24', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 25, title: 'EP 25: Silence', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=25', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 26, title: 'EP 26: Renewal', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=26', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 27, title: 'EP 27: Abduction', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=27', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 28, title: 'EP 28: Impatience', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=28', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 29, title: 'EP 29: Father', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=29', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 30, title: 'EP 30: Justice', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=30', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 31, title: 'EP 31: Transfer', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=31', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 32, title: 'EP 32: Selection', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=32', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 33, title: 'EP 33: Scorn', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=33', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 34, title: 'EP 34: Vigilance', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=34', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 35, title: 'EP 35: Malice', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=35', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 36, title: 'EP 36: 1.28', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=36', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' },
                { number: 37, title: 'EP 37: New World', videoUrl: ' https://multiembed.mov/?video_id=tt0877057&s=1&e=37', thumbnail: 'https://traditionalcatholicweeb.wordpress.com/wp-content/uploads/2023/04/death-note-light-yagami.jpg', downloads: { '1080p': '#', '720p': '#', '480p': '#' }, subtitleUrl: '#' }
            ];
            
            // --- Page Elements ---
            const videoPlayer = document.getElementById('video-player-iframe');
            const episodesListContainer = document.getElementById('episodes-list-container');
            const downloadLinksTbody = document.getElementById('download-links-tbody');
            const currentEpisodeTitle = document.getElementById('current-episode-title');
            const prevBtn = document.getElementById('prev-ep-btn');
            const nextBtn = document.getElementById('next-ep-btn');

            // --- Button Elements ---
            const playButton = document.getElementById('play-button');
            const mobilePlayButton = document.getElementById('mobile-play-button');
            const trailerButton = document.getElementById('trailer-button');
            const mobileTrailerButton = document.getElementById('mobile-trailer-button');
            const addToWatchlistBtn = document.getElementById('add-to-watchlist-btn');

            let currentEpisodeIndex = 0; // Index starting at 0
            const totalEpisodes = episodeData.length;

            function populateReviewSection() {
                // --- Review Population Logic ---
                document.title = `Review & Watch ${selectedAnime.title} - Anikan`;
                document.getElementById('hero-banner-section').style.backgroundImage = `url('${selectedAnime.bgImage}')`;
                document.getElementById('anime-title-main').textContent = selectedAnime.title;
                document.getElementById('hero-meta-year').textContent = selectedAnime.releaseYear;
                document.getElementById('hero-meta-type').textContent = selectedAnime.type;
                document.getElementById('hero-meta-duration').textContent = `${selectedAnime.duration}`;
                document.getElementById('anime-poster').src = selectedAnime.coverImage;
                document.getElementById('info-title').textContent = selectedAnime.title;
                document.getElementById('info-cast').textContent = selectedAnime.cast.join(', ');
                document.getElementById('info-creator').textContent = selectedAnime.creator;
                document.getElementById('info-genre').textContent = selectedAnime.genres.join(', ');
                const ratingCircle = document.getElementById('rating-circle');
                document.getElementById('rating-score').textContent = selectedAnime.rating;
                if (ratingCircle) {
                    ratingCircle.style.setProperty('--rating-percent', selectedAnime.rating * 10);
                }
                document.getElementById('synopsis-text').textContent = selectedAnime.description;
                // Using image URLs for the photos grid
                document.getElementById('photos-grid').innerHTML = selectedAnime.gallery.map(img => `<img src="${img}" alt="Gallery image">`).join('');
                document.getElementById('trailer-player').src = selectedAnime.trailer_url;
                document.getElementById('character-list').innerHTML = selectedAnime.characters.map(char =>
                    `<div class="character-card"><img src="${char.image}" alt="${char.name}"><h4>${char.name}</h4></div>`
                ).join('');
                document.getElementById('anime-audience').textContent = selectedAnime.audience;
                const officialStreamsContainer = document.getElementById('official-streams');
                officialStreamsContainer.innerHTML = selectedAnime.official_streams.map(stream =>
                    `<a href="#" class="stream-logo"><img src="${stream.logo}" alt="${stream.platform}"></a>`
                ).join('');
                
                // Populate Sidebar Info
                document.getElementById('sidebar-poster').src = selectedAnime.coverImage;
                document.getElementById('sidebar-title').textContent = selectedAnime.title;
                document.getElementById('sidebar-type').textContent = selectedAnime.type;
                document.getElementById('sidebar-episodes').textContent = selectedAnime.EPs;
                document.getElementById('sidebar-duration').textContent = selectedAnime.duration;
                document.getElementById('sidebar-studio').textContent = selectedAnime.studio;
                document.getElementById('sidebar-score').textContent = selectedAnime.rating + '/10';
                document.getElementById('sidebar-genres').textContent = selectedAnime.genres.join(', ');
            }
            
            // --- NEW LOGIC: Using episodeData constant ---

            function updateUI(episodeIndex) {
                currentEpisodeIndex = parseInt(episodeIndex, 10);
                const episode = episodeData[currentEpisodeIndex];
                
                if (!episode) return;
                
                const episodeNumber = episode.number;
                // Use regex to get the part of the title after the number/colon for cleaner display in the H1
                const displayTitle = episode.title.match(/(?::\s?)(.*)/)?.[1] || episode.title;

                currentEpisodeTitle.textContent = `You are watching Episode ${episodeNumber} - ${displayTitle}`;
                
                // 1. Update Video Player (Using non-functional placeholder)
                videoPlayer.src = episode.videoUrl;

                // 2. Update Download Links (Using non-functional placeholders)
                downloadLinksTbody.innerHTML = '';
                const downloadQualities = Object.keys(episode.downloads);
                const subtitleUrl = episode.subtitleUrl || '#';
                
                if (downloadQualities.length > 0) {
                     downloadQualities.forEach(quality => {
                        const downloadUrl = episode.downloads[quality];
                        downloadLinksTbody.innerHTML += `
                            <tr>
                                <td data-label="Episode">Episode ${episodeNumber}</td>
                                <td data-label="Quality">${quality}</td>
                                <td data-label="Video"><a href="${downloadUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-download"></i> Download</a></td>
                                <td data-label="Subtitles"><a href="${subtitleUrl}" class="download-btn" target="_blank" rel="noopener noreferrer"><i class="fas fa-closed-captioning"></i> Download</a></td>
                            </tr>`;
                    });
                } else {
                    downloadLinksTbody.innerHTML = `<tr><td colspan="4" style="text-align: center; color: var(--color-text-muted);">Download links not available for this episode.</td></tr>`;
                }
                
                // 3. Update Episode List Active State and scroll
                episodesListContainer.querySelectorAll('.episode-item').forEach(link => link.classList.remove('current'));
                const activeEpisodeLink = episodesListContainer.querySelector(`.episode-item[data-episode='${episodeNumber}']`);
                if (activeEpisodeLink) {
                    activeEpisodeLink.classList.add('current');
                    activeEpisodeLink.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }

                // 4. Update Navigation Buttons
                prevBtn.disabled = episodeNumber === 1;
                nextBtn.disabled = episodeNumber === totalEpisodes;
            }

            function generateEpisodeList() {
                episodesListContainer.innerHTML = '';
                episodeData.forEach((ep, index) => {
                    const episodeNumber = ep.number;
                    const episodeTitle = ep.title.match(/(?::\s?)(.*)/)?.[1] || ep.title; // Clean up title for display
                    
                    const itemHTML = `
                        <a class="episode-item" data-episode="${episodeNumber}" data-episode-index="${index}">
                            <img src="${ep.thumbnail}" alt="Ep ${episodeNumber}" class="episode-thumbnail">
                            <div class="ep-info">
                                <p class="ep-number">Episode ${episodeNumber}</p>
                                <p class="ep-desc">${episodeTitle}</p>
                            </div>
                        </a>
                    `;
                    episodesListContainer.innerHTML += itemHTML;
                });
                
                // Attach click listeners to the generated list items
                episodesListContainer.querySelectorAll('.episode-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        updateUI(item.dataset.episodeIndex);
                    });
                });
            }


            // --- Event Handlers ---
            const handlePlayClick = () => {
                document.body.classList.add('watching-active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                generateEpisodeList(); // Generate list and attach click handlers
                
                // Initialize the player with the first EP
                if (episodeData.length > 0) {
                    updateUI(0);
                }
            };
            
            const handleTrailerClick = () => {
                const trailerElement = document.getElementById('trailer-player');
                if (trailerElement) {
                    trailerElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };
            
            const handleAddToWatchlist = async () => {
                // Placeholder logic as in original
                const username = null; // Assuming no user is logged in
                if (!username) {
                    alert('Please log in to add to your watchlist.');
                    // window.location.href = '/login.html';
                    return;
                }
            };

            // --- Navigation Event Listeners ---
            prevBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex > 0) updateUI(currentEpisodeIndex - 1); 
            });
            nextBtn.addEventListener('click', () => { 
                if (currentEpisodeIndex < totalEpisodes - 1) updateUI(currentEpisodeIndex + 1); 
            });

            // --- Other Event Listeners ---
            playButton.addEventListener('click', handlePlayClick);
            mobilePlayButton.addEventListener('click', handlePlayClick);
            trailerButton.addEventListener('click', handleTrailerClick);
            mobileTrailerButton.addEventListener('click', handleTrailerClick);
            addToWatchlistBtn.addEventListener('click', handleAddToWatchlist);

            // --- Initialize Page ---
            populateReviewSection();
        });
    </script>
</body>
</html>